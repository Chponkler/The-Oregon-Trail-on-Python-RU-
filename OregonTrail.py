import random
import time
import sys

# Константы
S = S = ["", "БЕНГ", "ТРАХ", "ПИФ", "БАХ"]1
EVENTS = [6, 11, 13, 15, 17, 22, 32, 35, 37, 42, 44, 54, 64, 69, 95]
DATE_STR = [
    "12 АПРЕЛЯ ", "26 АПРЕЛЯ ", "10 МАЯ ", "24 МАЯ ", "7 ИЮНЯ ", "21 ИЮНЯ ",
    "5 ИЮЛЯ ", "19 ИЮЛЯ ", "2 АВГУСТА ", "16 АВГУСТА ", "31 АВГУСТА ",
    "13 СЕНТЯБРЯ ", "27 СЕНТЯБРЯ ", "11 ОКТЯБРЯ ", "25 ОКТЯБРЯ ",
    "8 НОЯБРЯ ", "22 НОЯБРЯ ", "6 ДЕКАБРЯ ", "20 ДЕКАБРЯ "
]
DAYS = ["", "ПОНЕДЕЛЬНИК ", "ВТОРНИК ", "СРЕДА ", "ЧЕТВЕРГ ", "ПЯТНИЦА ", "СУББОТА ", "ВОСКРЕСЕНЬЕ "]
ILLNESSES = ["дизентерия", "холера", "тиф", "пневмония", "цинга", "малярия", "оспа", "корь", "туберкулёз", "грипп"]
FORTS = [(250, 330, "Fort Kearney"), (950, 1000, "Fort Bridger"),
         (1550, 1650, "Fort Boise")]

# Глобальные переменные
A = B = C = F = M = M1 = M2 = T = B1 = F9 = 0.0
C1 = D1 = D3 = D9 = E = F1 = F2 = K8 = L1 = M9 = P = R1 = S4 = S5 = S6 = T1 = X = 0
X1 = -1

def instructions():
    print("ЭТА ПРОГРАММА ИМИТИРУЕТ ПУТЕШЕСТВИЕ ПО ОРЕГОНСКОЙ ТРОПЕ ОТ")
    print("ИНДЕПЕНДЕНС, МИССУРИ, ДО ОРЕГОН-СИТИ, ОРЕГОН, В 1847 ГОДУ.")
    print("ВАША СЕМЬЯ ИЗ ПЯТИ ЧЕЛОВЕК ПРОЙДЕТ 2040 МИЛЬ ПО ОРЕГОНСКОЙ ТРОПЕ")
    print("ЗА 5-6 МЕСЯЦЕВ --- ЕСЛИ ВЫ ДОЖИВЕТЕ.")
    print()
    print("ВЫ СОБРАЛИ $900 НА ПОЕЗДКУ, И ТОЛЬКО ЧТО")
    print("   ЗАПЛАТИЛИ $200 ЗА ТЕЛЕГУ.")
    print("ВАМ НУЖНО ПОТРАТИТЬ ОСТАЛЬНЫЕ ДЕНЬГИ НА СЛЕДУЮЩИЕ ВЕЩИ:")
    print()
    print("     ВОЛЫ - ВЫ МОЖЕТЕ ПОТРАТИТЬ $200-$300 НА СВОЮ УПРЯЖКУ")
    print("            ЧЕМ БОЛЬШЕ ПОТРАТИТЕ, ТЕМ БЫСТРЕЕ ПОЕДЕТЕ")
    print("               ПОТОМУ ЧТО У ВАС БУДУТ ЛУЧШИЕ ЖИВОТНЫЕ")
    print()
    print("     ЕДА - ЧЕМ БОЛЬШЕ У ВАС ЕСТЬ, ТЕМ МЕНЬШЕ ШАНСОВ ЗАБОЛЕТЬ")
    print()
    print("     ПАТРОНЫ - $1 ПОКУПАЕТ ПОЯС С 50 ПУЛЯМИ")
    print("            ПУЛИ НУЖНЫ ДЛЯ АТАК ЖИВОТНЫХ И БАНДИТОВ, И ДЛЯ ОХОТЫ НА ЕДУ")
    print()
    print("     ОДЕЖДА - ЭТО ОСОБЕННО ВАЖНО ДЛЯ ХОЛОДНОЙ ПОГОДЫ")
    print("               КОТОРУЮ ВЫ ВСТРЕТИТЕ ПРИ ПЕРЕСЕЧЕНИИ ГОР")
    print()
    print("     РАЗНЫЕ ПРИПАСЫ - СЮДА ВХОДЯТ ЛЕКАРСТВА И ДРУГИЕ ВЕЩИ")
    print("               КОТОРЫЕ НУЖНЫ ДЛЯ БОЛЕЗНЕЙ И АВАРИЙНОГО РЕМОНТА")
    print()
    print()
    print("ВЫ МОЖЕТЕ ПОТРАТИТЬ ВСЕ ДЕНЬГИ ПЕРЕД НАЧАЛОМ ПОЕЗДКИ -")
    print("ИЛИ СОХРАНИТЬ ЧАСТЬ ДЕНЕГ ДЛЯ ПОКУПОК В ФОРТАХ ПО ПУТИ,")
    print("КОГДА ЗАКОНЧАТСЯ ПРИПАСЫ. ОДНАКО ВЕЩИ В ФОРТАХ СТОЯТ ДОРОЖЕ.")
    print("ВЫ ТАКЖЕ МОЖЕТЕ ОХОТИТЬСЯ ПО ПУТИ, ЧТОБЫ ПОЛУЧИТЬ БОЛЬШЕ ЕДЫ.")
    print("КОГДА ВАМ ПРИДЕТСЯ ИСПОЛЬЗОВАТЬ СВОЮ ВИНТОВКУ ПО ПУТИ,")
    print("ВАМ СКАЖУТ ВВЕСТИ СЛОВО (ПОХОЖЕЕ НА ЗВУК ВЫСТРЕЛА).")
    print("ЧЕМ БЫСТРЕЕ ВЫ ВВЕДЕТЕ ЭТО СЛОВО И НАЖМЕТЕ 'ENTER',")
    print("ТЕМ ЛУЧШЕ УДАЧА БУДЕТ С ВАШЕЙ ВИНТОВКОЙ.")
    print()
    print("В КАЖДОМ ХОДЕ ВСЕ ПРЕДМЕТЫ ПОКАЗЫВАЮТСЯ В ДОЛЛАРОВЫХ СУММАХ")
    print("КРОМЕ ПАТРОНОВ")
    print("КОГДА ПРОСЯТ ВВЕСТИ СУММУ ДЕНЕГ, НЕ ИСПОЛЬЗУЙТЕ '$'.")
    print()
    print("УДАЧИ!!!")

def shooting():
    global B1, S6
    S6 = random.randint(1, 4)
    print("НАПИШИТЕ", S[S6])
    print()  # Разделитель
    start_time = time.time()
    response = input().upper().strip()
    B1 = int((time.time() - start_time) * 2 - (D9 - 1))
    if B1 < 0:
        B1 = 0
    if response != S[S6]:
        B1 = 9
    print()  # Разделитель

def spend():
    global P, T
    P = float(input())
    if P < 0:
        return
    T -= P
    if T >= 0:
        return
    print("У ВАС НЕТ СТОЛЬКО--СОКРАТИТЕ РАСХОДЫ")
    print("ВЫ УПУСКАЕТЕ ШАНС ПОТРАТИТЬ НА ЭТУ ВЕЩЬ")
    T += P
    P = 0
    print()  # Разделитель

def illness():
    global M, M1, S4
    disease = random.choice(ILLNESSES)
    rnd = random.random() * 100
    if rnd < 10 + 35 * (E - 1):
        print(f"ЛЕГКИЙ(АЯ) {disease.upper()}---ИСПОЛЬЗОВАНО ЛЕКАРСТВО")
        M -= 5
        M1 -= 2
    elif rnd < 100 - (40 / (4 ** (E - 1))):
        print(f"СЕРЬЕЗНЫЙ(АЯ) {disease.upper()}---ИСПОЛЬЗОВАНО ЛЕКАРСТВО")
        M -= 5
        M1 -= 5
    else:
        print(f"ТЯЖЕЛЫЙ(АЯ) {disease.upper()}")
        print("ВЫ ДОЛЖНЫ ОСТАНОВИТЬСЯ ДЛЯ МЕДИЦИНСКОЙ ПОМОЩИ")
        M1 -= 10
        S4 = 1

    if M1 < 0:
        print("У ВАС ЗАКОНЧИЛИСЬ МЕДИЦИНСКИЕ ПРИПАСЫ")
        print(f"ВЫ УМЕРЛИ ОТ {disease.upper()}")
        dying()
    print()  # Разделитель

def dying():
    print()
    print("ИЗ-ЗА ВАШЕЙ НЕСЧАСТНОЙ СИТУАЦИИ МЫ ДОЛЖНЫ ПРОЙТИ НЕСКОЛЬКО")
    print("ФОРМАЛЬНОСТЕЙ")
    print()
    print("ХОТИТЕ ЛИ ВЫ СВЯЩЕННИКА?")
    input()
    print("ХОТИТЕ ЛИ РОСКОШНЫЕ ПОХОРОНЫ?")
    input()
    print("ХОТИТЕ ЛИ МЫ СООБЩИМ ВАШИМ БЛИЖАЙШИМ РОДСТВЕННИКАМ?")
    c = input().lower()
    if c == "да" or c == "y":
        print("ЭТО БУДЕТ $4.50 ЗА ТЕЛЕГРАММУ.")
        print()
    else:
        print("НО ВАША ТЕТЯ СЭДИ В СЕНТ-ЛУИСЕ ОЧЕНЬ БЕСПОКОИТСЯ О ВАС")
        print()
    print("МЫ БЛАГОДАРИМ ВАС ЗА ЭТУ ИНФОРМАЦИЮ И СОЖАЛЕЕМ, ЧТО ВЫ")
    print("НЕ ДОБРАЛИСЬ ДО ВЕЛИКОЙ ТЕРРИТОРИИ ОРЕГОН")
    print("УДАЧИ В СЛЕДУЮЩИЙ РАЗ")
    print()
    print()
    print("                                ИСКРЕННЕ")
    print()
    print("                 ТОРГОВАЯ ПАЛАТА ОРЕГОН-СИТИ")
    sys.exit(0)

def arrival():
    global F, F9, D3
    F9 = (2040 - M2) / (M - M2)
    F += (1 - F9) * (8 + 5 * E)
    print()
    print("ВЫ НАКОНЕЦ ДОБРАЛИСЬ ДО ОРЕГОН-СИТИ")
    print("ПОСЛЕ 2040 ДОЛГИХ МИЛЬ---УРА !!!!!")
    print("НАСТОЯЩИЙ ПИОНЕР!")
    print()
    F9 = int(F9 * 14)
    D3 = D3 * 14 + F9
    F9 += 1
    if F9 >= 8:
        F9 -= 7
    print(DAYS[F9], end="")
    if D3 <= 124:
        D3 -= 93
        print("ИЮЛЬ", D3, "1847")
    elif D3 <= 155:
        D3 -= 124
        print("АВГУСТ", D3, "1847")
    elif D3 <= 185:
        D3 -= 155
        print("СЕНТЯБРЬ", D3, "1847")
    elif D3 <= 216:
        D3 -= 185
        print("ОКТЯБРЬ", D3, "1847")
    elif D3 <= 246:
        D3 -= 216
        print("НОЯБРЬ", D3, "1847")
    else:
        D3 -= 246
        print("ДЕКАБРЬ", D3, "1847")
    print()
    print(f"{'ЕДА':^10} | {'ПАТРОНЫ':^10} | {'ОДЕЖДА':^10} | {'РАЗНЫЕ ПРИПАСЫ':^15} | {'ДЕНЬГИ':^10}")
    print(f"{int(max(0, F)):^10} | {int(max(0, B)):^10} | {int(max(0, C)):^10} | {int(max(0, M1)):^15} | {int(max(0, T)):^10}")
    print()
    print("           ПРЕЗИДЕНТ ДЖЕЙМС К. ПОЛК ПОСЫЛАЕТ ВАМ СВОИ")
    print("                   СЕРДЕЧНЫЕ ПОЗДРАВЛЕНИЯ")
    print()
    print("           И ЖЕЛАЕТ ВАМ ПРОЦВЕТАЮЩЕЙ ЖИЗНИ ВПЕРЕДИ")
    print()
    print("                    В ВАШЕМ НОВОМ ДОМЕ")
    sys.exit(0)

def print_date():
    global D3
    D3 += 1
    if D3 > 19:
        print("ВЫ БЫЛИ В ПУТИ СЛИШКОМ ДОЛГО ------")
        print("ВАША СЕМЬЯ УМИРАЕТ В ПЕРВОЙ ЗИМНЕЙ БУРЕ")
        dying()
    print("ПОНЕДЕЛЬНИК " + DATE_STR[D3 - 1] + "1847")
    print()  # Разделитель

def near_fort():
    for start, end, _ in FORTS:
        if start <= M < end:
            return True
    return False

def handle_start_turn():
    global F, B, C, M1, T, M, M2, K8, S4, M9
    F = max(0, int(F))
    B = max(0, int(B))
    C = max(0, int(C))
    M1 = max(0, int(M1))
    T = int(T)
    M = int(M)
    M2 = M
    if S4 == 1 or K8 == 1:
        T -= 20
        if T < 0:
            print("ВЫ НЕ МОЖЕТЕ ПОЗВОЛИТЬ СЕБЕ ДОКТОРА")
            print("ВЫ УМЕРЛИ ОТ ", end="")
            if K8 == 1:
                print("РАНЕНИЙ")
            else:
                print("ПНЕВМОНИИ")
            dying()
        print("СЧЕТ ДОКТОРА $20")
        K8 = S4 = 0
        print()  # Разделитель
    if M9 == 0:
        print("ОБЩИЙ ПРОБЕГ", M)
    else:
        print("ОБЩИЙ ПРОБЕГ 950")
        M9 = 0
    print()  # Разделитель после пробега
    if F < 13:
        print("ВАМ ЛУЧШЕ ПООХОТИТЬСЯ ИЛИ КУПИТЬ ЕДЫ, И ПОСКОРЕЕ!!!!")
        print()  # Разделитель
    print(f"{'ЕДА':^10} | {'ПАТРОНЫ':^10} | {'ОДЕЖДА':^10} | {'РАЗНЫЕ ПРИПАСЫ':^15} | {'ДЕНЬГИ':^10}")
    print(f"{F:^10} | {B:^10} | {C:^10} | {M1:^15} | {T:^10}")
    print()  # Разделитель после статуса

def get_action():
    global X, X1
    has_fort = near_fort()
    if X1 == -1:
        print("ХОТИТЕ ЛИ ВЫ (1) ОХОТИТЬСЯ, ИЛИ (2) ПРОДОЛЖИТЬ")
        if has_fort:
            print("ИЛИ (3) ОСТАНОВИТЬСЯ В БЛИЖАЙШЕМ ФОРТЕ")
        X = int(input())
        if has_fort and X == 3:
            X = 1  # Форт
        elif X == 1:
            X = 2  # Охота
        else:
            X = 3  # Продолжить
        if X == 2 and B < 39:
            print("НЕ УДАЛОСЬ---ВАМ НУЖНО БОЛЬШЕ ПАТРОНОВ ДЛЯ ОХОТЫ")
            X1 *= -1
            print()  # Разделитель
            return False
    else:
        X1 *= -1
        print("ХОТИТЕ ЛИ ВЫ (1) ОСТАНОВИТЬСЯ В СЛЕДУЮЩЕМ ФОРТЕ, (2) ОХОТИТЬСЯ, ИЛИ (3) ПРОДОЛЖИТЬ")
        X = int(input())
        if X < 1 or X > 3:
            X = 3
    return True

def handle_action():
    global M, F, B, C, M1
    if X == 1:  # Форт
        for start, end, name in FORTS:
            if start <= M < end:
                print(f"ВЫ ДОСТИГЛИ {name.upper()}")
                break
        print("ВВЕДИТЕ, СКОЛЬКО ВЫ ХОТИТЕ ПОТРАТИТЬ НА СЛЕДУЮЩЕЕ")
        print("ЕДА", end=" ")
        spend()
        F += (2 / 3) * P
        print("ПАТРОНЫ", end=" ")
        spend()
        B += int((2 / 3) * P * 50)
        print("ОДЕЖДА", end=" ")
        spend()
        C += (2 / 3) * P
        print("РАЗНЫЕ ПРИПАСЫ", end=" ")
        spend()
        M1 += (2 / 3) * P
        M += 45  # Достичь форта
        print()  # Разделитель
    elif X == 2:  # Охота
        if B < 39:
            print("ЖЕСТКО---ВАМ НУЖНО БОЛЬШЕ ПАТРОНОВ ДЛЯ ОХОТЫ")
            print()  # Разделитель
            return False  # Повторить
        M -= 45
        shooting()
        if B1 <= 1:
            print("ПРЯМО МЕЖДУ ГЛАЗ---ВЫ ПОДСТРЕЛИЛИ БОЛЬШОГО!!!!")
            print("ПОЛНЫЕ ЖИВОТЫ СЕГОДНЯ ВЕЧЕРОМ!")
            F += 52 + random.randint(0, 6)
            B -= 10 + random.randint(0, 3)
        elif random.random() * 100 < 13 * B1:
            print("ВЫ ПРОМАХНУЛИСЬ---И ВАШ УЖИН УБЕЖАЛ.....")
        else:
            print("ХОРОШИЙ ВЫСТРЕЛ--ПРЯМО В ЦЕЛЬ--СЕГОДНЯ ВЫ ХОРОШО ПОУЖИНАЕТЕ!!")
            F += 48 - 2 * B1
            B -= 10 + 3 * B1
        print()  # Разделитель
    return True

def handle_eating():
    global F, M, L1, C1, E
    if F < 13:
        print("У ВАС ЗАКОНЧИЛАСЬ ЕДА, И ВЫ УМЕРЛИ ОТ ГОЛОДА")
        dying()
    print("ХОТИТЕ ЛИ ВЫ ЕСТЬ (1) ПЛОХО  (2) УМЕРЕННО")
    print("ИЛИ (3) ХОРОШО", end=" ")
    E = int(input())
    if E < 1 or E > 3:
        E = 1
    need = 8 + 5 * E
    if F < need:
        print("ВЫ НЕ МОЖЕТЕ ЕСТЬ ТАК ХОРОШО")
        print()  # Разделитель
        return False
    F -= need
    M += 170 + (A - 200) / 10 + 10 * random.random()  # Сбалансированная формула
    L1 = C1 = 0
    print()  # Разделитель
    return True

def handle_riders():
    global M, M1, B, A, K8, S5, T1
    if random.random() * 10 > ((M / 100 - 4) ** 2 + 72) / ((M / 100 - 4) ** 2 + 12) - 1:
        return
    print("ВСАДНИКИ ВПЕРЕДИ.  ОНИ ", end="")
    S5 = 0
    if random.random() < 0.8:
        print("НЕ ", end="")
        S5 = 1
    print("ВЫГЛЯДЯТ ВРАЖДЕБНО")
    print("ТАКТИКА")
    print("(1) БЕЖАТЬ  (2) АТАКОВАТЬ  (3) ПРОДОЛЖИТЬ  (4) КРУГ ИЗ ТЕЛЕГ")
    if random.random() < 0.2:
        S5 = 1 - S5
    T1 = int(input())
    if T1 < 1 or T1 > 4:
        T1 = 3
    if S5 == 0:  # Враждебные
        if T1 == 1:
            M += 20
            M1 -= 15
            B -= 150
            A -= 40
        elif T1 == 2:
            shooting()
            B -= B1 * 40 + 80
            if B < 0:
                print("У ВАС ЗАКОНЧИЛИСЬ ПАТРОНЫ, И ВАС УБИЛИ ВСАДНИКИ")
                dying()
            if B1 <= 1:
                print("ХОРОШАЯ СТРЕЛЬБА---ВЫ ОТБИЛИ НАПАДЕНИЕ")
            elif B1 <= 4:
                print("ВЫ НЕ УСПЕЛИ ДОСТАТЬ ВАШ КОЛЬТ.45")
            else:
                print("ПЛОХОЙ ВЫСТРЕЛ---ВАС ПОРЕЗАЛИ НОЖОМ")
                K8 = 1
                print("ВАМ НУЖНО ПОСЕТИТЬ СТАРОГО ДОКТОРА БЛАНШАРА")
        elif T1 == 3:
            if random.random() < 0.8:
                print("ОНИ НЕ АТАКОВАЛИ")
            else:
                B -= 150
                M1 -= 15
        elif T1 == 4:
            shooting()
            B -= B1 * 30 + 80
            M -= 25
            if B < 0:
                print("У ВАС ЗАКОНЧИЛИСЬ ПАТРОНЫ, И ВАС УБИЛИ ВСАДНИКИ")
                dying()
            if B1 <= 1:
                print("ХОРОШАЯ СТРЕЛЬБА---ВЫ ОТБИЛИ НАПАДЕНИЕ")
            elif B1 <= 4:
                print("ВЫ НЕ УСПЕЛИ ДОСТАТЬ ВАШ КОЛЬТ.45")
            else:
                print("ПЛОХОЙ ВЫСТРЕЛ---ВАС ПОРЕЗАЛИ НОЖОМ")
                K8 = 1
                print("ВАМ НУЖНО ПОСЕТИТЬ СТАРОГО ДОКТОРА БЛАНШАРА")
    else:  # Дружественные
        if T1 == 1:
            M += 15
            A -= 10
        elif T1 == 2:
            M -= 5
            B -= 100
        elif T1 == 3:
            pass
        elif T1 == 4:
            M -= 20
    if B < 0:
        print("У ВАС ЗАКОНЧИЛИСЬ ПАТРОНЫ, И ВАС УБИЛИ ВСАДНИКИ")
        dying()
    if S5 == 0:
        print("ВСАДНИКИ БЫЛИ ВРАЖДЕБНЫМИ--ПРОВЕРЬТЕ ПОТЕРИ")
    else:
        print("ВСАДНИКИ БЫЛИ ДРУЖЕСТВЕННЫМИ, ВСЕ В ПОРЯДКЕ")
    print()  # Разделитель

def handle_event():
    global R1, D1, F, B, M, M1, C, A, K8, C1
    R1 = random.random() * 100
    D1 = 0
    while D1 < 15 and R1 > EVENTS[D1]:
        D1 += 1
    if D1 == 15:
        print("ПОМОГАЮЩИЕ ИНДЕЙЦЫ ПОКАЗЫВАЮТ, ГДЕ НАЙТИ БОЛЬШЕ ЕДЫ")
        F += 14
    elif D1 == 0:
        print("ТЕЛЕГА ЛОМАЕТСЯ--ТЕРЯЕТЕ ВРЕМЯ И ПРИПАСЫ НА РЕМОНТ")
        M -= 15 + 5 * random.random()
        M1 -= 8
    elif D1 == 1:
        print("ВОЛ РАНИТ НОГУ--ЗАМЕДЛЯЕТ ВАС НА ОСТАТОК ПУТИ")
        M -= 25
        A -= 20
    elif D1 == 2:
        print("НЕУДАЧА--ВАША ДОЧЬ СЛОМАЛА РУКУ")
        print("ВЫ ОСТАНОВИЛИСЬ И ИСПОЛЬЗОВАЛИ ПРИПАСЫ ДЛЯ ШИНЫ")
        M -= 5 + 4 * random.random()
        M1 -= 2 + 3 * random.random()
    elif D1 == 3:
        print("ВОЛ УБЕГАЕТ--ТЕРЯЕТЕ ВРЕМЯ НА ПОИСКИ")
        M -= 17
    elif D1 == 4:
        print("ВАШ СЫН ПОТЕРЯЛСЯ---ТЕРЯЕТЕ ПОЛДНЯ НА ПОИСКИ")
        M -= 10
    elif D1 == 5:
        print("ГРЯЗНАЯ ВОДА--ТЕРЯЕТЕ ВРЕМЯ НА ПОИСКИ ЧИСТОГО ИСТОЧНИКА")
        M -= 2 + 10 * random.random()
    elif D1 == 6:
        if M > 950:
            print("ХОЛОДНАЯ ПОГОДА---БРРРРРР!---ВЫ ", end="")
            C1 = 0
            if C < 22 + 4 * random.random():
                print("НЕ ", end="")
                C1 = 1
            print("ИМЕЕТЕ ДОСТАТОЧНО ОДЕЖДЫ, ЧТОБЫ СОГРЕТЬСЯ")
            if C1 == 1:
                illness()
        else:
            print("СИЛЬНЫЕ ДОЖДИ---ТЕРЯЕТЕ ВРЕМЯ И ПРИПАСЫ")
            F -= 10
            B -= 500
            M1 -= 15
            M -= 5 + 10 * random.random()
    elif D1 == 7:
        print("АТАКА БАНДИТОВ")
        shooting()
        B -= 20 * B1
        if B < 0:
            print("У ВАС ЗАКОНЧИЛИСЬ ПАТРОНЫ---ОНИ ЗАБРАЛИ МНОГО ДЕНЕГ")
            T /= 3
        if B1 > 1:
            print("ВАС РАНИЛИ В НОГУ, И ОНИ УКРАЛИ ОДНОГО ИЗ ВАШИХ ВОЛОВ")
            K8 = 1
            print("ЛУЧШЕ ПОКАЖИТЕСЬ ДОКТОРУ")
            M1 -= 5
            A -= 20
        else:
            print("САМЫЙ БЫСТРЫЙ КУРОК ЗА ПРЕДЕЛАМИ ДОДЖ-СИТИ!!!")
            print("ВЫ ИХ ПОБЕДИЛИ!")
    elif D1 == 8:
        print("ПОЖАР В ТЕЛЕГЕ--ПОВРЕЖДЕНА ЕДА И ПРИПАСЫ!")
        F -= 40
        B -= 400
        M1 -= 3 + 8 * random.random()
        M -= 15
    elif D1 == 9:
        print("ПОТЕРЯЛИСЬ В ГУСТОМ ТУМАНЕ---ТЕРЯЕТЕ ВРЕМЯ")
        M -= 10 + 5 * random.random()
    elif D1 == 10:
        print("ВЫ УБИЛИ ЯДОВИТУЮ ЗМЕЮ ПОСЛЕ ТОГО, КАК ОНА УКУСИЛА ВАС")
        B -= 10
        M1 -= 5
        if M1 < 0:
            print("ВЫ УМЕРЛИ ОТ УКУСА ЗМЕИ, ПОТОМУ ЧТО У ВАС НЕТ ЛЕКАРСТВА")
            dying()
    elif D1 == 11:
        print("ТЕЛЕГА ЗАСТРЯЛА ПРИ ПЕРЕПРАВЕ ЧЕРЕЗ РЕКУ--ПОТЕРЯНА ЕДА И ОДЕЖДА")
        F -= 30
        C -= 20
        M -= 20 + 20 * random.random()
    elif D1 == 12:
        print("АТАКА ДИКИХ ЖИВОТНЫХ!")
        shooting()
        if B < 39:
            print("У ВАС СЛИШКОМ МАЛО ПАТРОНОВ--")
            print("ВОЛКИ ОДОЛЕЛИ ВАС")
            K8 = 1
            print("ВЫ УМЕРЛИ ОТ РАНЕНИЙ")
            dying()
        if B1 < 2:
            print("ХОРОШАЯ СТРЕЛЬБА, ПАРТНЕР---ОНИ НЕ МНОГО ВЗЯЛИ")
        else:
            print("МЕДЛЕННО СТРЕЛЯЕТЕ---ОНИ ДОБРАЛИСЬ ДО ВАШЕЙ ЕДЫ И ОДЕЖДЫ")
        B -= 20 * B1
        C -= B1 * 4
        F -= B1 * 8
    elif D1 == 13:
        trigger = E == 1 or (E == 2 and random.random() > 0.25) or (E == 3 and random.random() > 0.5)
        if trigger:
            illness()
    elif D1 == 14:
        print("ГРАД И БУРЯ---ПОВРЕЖДЕНЫ ПРИПАСЫ")
        M -= 5 + 10 * random.random()
        B -= 200
        M1 -= 4 + 3 * random.random()
    print()  # Разделитель после события

def handle_mountains():
    global M, M1, B, F1, F2, L1, C1, F
    if M <= 950:
        return
    prob = ((M / 100 - 15) ** 2 + 72) / ((M / 100 - 15) ** 2 + 12)
    if random.random() * 10 > 9 - prob:
        return
    print("СУРОВЫЕ ГОРЫ")
    rnd = random.random()
    if rnd <= 0.1:
        print("ВЫ ЗАБЛУДИЛИСЬ---ТЕРЯЕТЕ ЦЕННОЕ ВРЕМЯ, ПЫТАЯСЬ НАЙТИ ТРОПУ!")
        M -= 60
    elif rnd <= 0.11:
        print("ТЕЛЕГА ПОВРЕЖДЕНА!---ТЕРЯЕТЕ ВРЕМЯ И ПРИПАСЫ")
        M1 -= 5
        B -= 200
        M -= 20 + 30 * random.random()
    else:
        print("ДОРОГА СТАНОВИТСЯ ТРУДНОЙ")
        M -= 45 + random.random() / 0.02
    print()  # Разделитель
    if F1 == 0:
        F1 = 1
        if random.random() < 0.8:
            print("ВЫ БЕЗОПАСНО ПРОШЛИ SOUTH PASS--НЕТ СНЕГА")
            print()  # Разделитель
    if M >= 1700 and F2 == 0:
        F2 = 1
        if random.random() >= 0.7:
            print("БУРАН НА ГОРНОЙ ТРОПЕ--ТЕРЯЕТЕ ВРЕМЯ И ПРИПАСЫ")
            L1 = 1
            F -= 25
            M1 -= 10
            B -= 300
            M -= 30 + 40 * random.random()
            if C < 18 + 2 * random.random():
                illness()
            print()  # Разделитель
    if M <= 950:
        global M9
        M9 = 1

# Настройка игры
c_input = input("НУЖНЫ ЛИ ИНСТРУКЦИИ (да/нет) ").lower()
if c_input not in ["нет",'N','NO','no','n']:
    instructions()

print()
print("НАСКОЛЬКО ХОРОШО ВЫ СТРЕЛЯЕТЕ ИЗ ВИНТОВКИ?")
print("  (1) АС МЕТКОСТИ,  (2) ХОРОШИЙ СТРЕЛОК,  (3) СРЕДНИЙ")
print("         (4) НУЖНО БОЛЬШЕ ПРАКТИКИ,  (5) ДРОЖАЩИЕ КОЛЕНИ")
print("ВВЕДИТЕ ОДНО ИЗ ВЫШЕУКАЗАННЫХ -- ЧЕМ ЛУЧШЕ ВЫ СЕБЯ ОЦЕНИВАЕТЕ, ТЕМ")
print("БЫСТРЕЕ ВЫ ДОЛЖНЫ УПРАВЛЯТЬСЯ С ВИНТОВКОЙ, ЧТОБЫ УСПЕТЬ.")
D9 = int(input())
if D9 > 5 or D9 < 1:
    D9 = 0

# Начальные покупки (изменено для волов)
print()
print()
while True:
    print("СКОЛЬКО ВОЛОВ ВЫ ХОТИТЕ КУПИТЬ? (минимум 10, максимум 15, цена за одного - 20$)")
    oxen = int(input())
    if oxen < 10 or oxen > 15:
        print("НЕВОЗМОЖНО - ДИАПАЗОН 10-15")
        continue
    A = oxen * 20
    if A < 200 or A > 300:
        print("СТОИМОСТЬ ДОЛЖНА БЫТЬ 200-300$")
        continue
    print("СКОЛЬКО ВЫ ХОТИТЕ ПОТРАТИТЬ НА ЕДУ", end=" ")
    F = float(input())
    if F < 0:
        print("НЕВОЗМОЖНО")
        continue
    print("СКОЛЬКО ВЫ ХОТИТЕ ПОТРАТИТЬ НА ПАТРОНЫ", end=" ")
    B = float(input())
    if B < 0:
        print("НЕВОЗМОЖНО")
        continue
    print("СКОЛЬКО ВЫ ХОТИТЕ ПОТРАТИТЬ НА ОДЕЖДУ", end=" ")
    C = float(input())
    if C < 0:
        print("НЕВОЗМОЖНО")
        continue
    print("СКОЛЬКО ВЫ ХОТИТЕ ПОТРАТИТЬ НА РАЗНЫЕ ПРИПАСЫ", end=" ")
    M1 = float(input())
    if M1 < 0:
        print("НЕВОЗМОЖНО")
        continue
    spent = A + F + B + C + M1
    if spent > 700:
        print("ВЫ ПЕРЕРАСХОДОВАЛИ--У ВАС БЫЛО ТОЛЬКО $700. ПОКУПАЙТЕ ЗАНОВО.")
        continue
    T = 700 - spent
    B *= 50
    print("ПОСЛЕ ВСЕХ ПОКУПОК У ВАС ОСТАЛОСЬ", T, "ДОЛЛАРОВ")
    print()
    print("ПОНЕДЕЛЬНИК 29 МАРТА 1847")
    print()
    break

# Основной цикл
while True:
    if M >= 2040:
        arrival()
    print_date()
    handle_start_turn()
    while not get_action() or not handle_action():
        pass
    while not handle_eating():
        pass
    handle_riders()
    handle_event()
    handle_mountains()
    print('-----------------------------------------------------------')
